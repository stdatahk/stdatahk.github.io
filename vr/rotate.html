<html>
<head>
<title>Tool for Quick Fixing VR360 Raw Photo</title>
</head>
<body style="font-family:Arial;">
<form>
Image Location: <input name='ImgUrl' type=text size=45 value='https://stdatahk.com/vr/dualfisheye.jpg'><br>
<input type=button value=" SHOW " onClick="document.theImg.src=document.forms[0].ImgUrl.value;">
<br>Preview:<br>
<img name='theImg' id='theImg' src="https://stdatahk.com/vr/dualfisheye.jpg">

<hr>              

<p>Canvas:</p>
<canvas id="theCanvas" width="1" height="1" style="border:1px solid #d3d3d3;"></canvas>

<br><input type=button onclick="doRotate();" value=" ROTATE ">

<script>
function doRotate() {
  var c = document.getElementById("theCanvas");
  var ctx = c.getContext("2d");
  var img = document.getElementById("theImg");
  c.width = img.width;
  c.height = img.height;
  ctx.drawImage(img,0,0);  
  //img.height = Math.round(img.height*300/img.width);
  //img.width = 300;

  drawRotated(c,ctx,180,img, 0,0,img.width/2,img.height, 0,0,img.width/2,img.height);
}
  
function drawRotated(canvas, context, degrees, image, sx,sy,sw,sh,dx,dy,dw,dh){
    //context.clearRect(0,0,canvas.width,canvas.height);
    context.save();
    context.translate(canvas.width/2,canvas.height/2);
    context.rotate(degrees*Math.PI/180);
    context.translate(-canvas.width/2,-canvas.height/2);
    context.drawImage(image,sx,sy,sw,sh,dx-300,dy,dw,dh); 
    context.restore();
}
</script>
              
</form>
</body>
</html>
