
<html>
<head>
<title>VR360 | Project | List </title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>
<br>

<h2 style="font-family:Arial;">所有 VR360 項目清單：</h2>

<div id="theDiv" style="text-align:right;">
<input style="width:140px;height:80px;" type=button value=" 新增項目 " onclick="location.href='project_add.html';">
</div>
<br>


<table id='tbl' width='100%' border=1 cellpadding=2 cellspacing=0 style="font-family:Arial;">
<!-- table header -->
<tr>
<td width=150 style="font-weight:bold;font-size:20px;">
	項目 ID
</td>
<td style="font-weight:bold;font-size:20px;">
	項目詳細內容
</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<!-- end table header -->
<tr id='tr0'>
<td>
	Loading...
</td>
<td>
	Loading...
</td>
</tr>
</table>

<!--
GAS:
https://script.google.com/d/1qBAZVtgous1OrHGTnQa5v_xVOnBrumfHBElN6rmqQV0cU48V8IqsSIHH/edit
GDrv:
https://drive.google.com/drive/folders/1ZlVksQr_RwkoqJhquX1482jFkodqbggP
GSS:
https://docs.google.com/spreadsheets/u/0/
-->
<script language="JavaScript">
<!--
var gasId = "AKfycbwHLSiDw3M30YfAjThHfy0a7BEbzcbho_YPpPXAFAVFD5pWnvg_";
var gssId = "1TZBtReaafWTVzeyDkQzMGFJd4_bycYOhJOmVNdiAMeU"; //for vrproj page
var gasUrl = "https://script.google.com/macros/s/"+ gasId +"/exec";

$(document).ready(function(){
	$.ajax({
	  url: gasUrl,
	  cache: false,
	  type: "GET",
	  data: {
		func: 'GETDATA', 
		id: gssId,  
		key: 'P@$$w0rd!'
	  },
	  dataType: "html",
	  success: function(html){
	  
		var ary = null;
		var rst = "";
		html = "ary="+html+";";
	        eval(html);

		if(ary.length > 0) {
			$("#tr0").remove();
			$("#tbl").prepend("共 "+ ary.length +" 筆資料");
		}

		for(var i=0; i<ary.length; i++) {
			rst += "<tr>";
			var data = ary[i][1];
			
			if(data.indexOf('txt')>0) {
				var data = decodeURI(data);
				data = "data="+data+";";
				data = eval(data);
				rst += "<td>"+ ary[i][0] +"</td>";
				rst += "<td>"+ data.txt +"</td>";
				rst += "<td><input type='button' value='顯示360照片' onclick='window.open(\"project_dirlist.html?"+ data.fid +"|"+ ary[i][0] +"\");'></td>";
				rst += "<td><input type='button' value='打開GDrive資料夾' onclick='window.open(\"https:\/\/drive.google.com\/drive\/folders\/'+ data.fid +'\");'></td>";
				rst += "<td><input type='button' value='預覽VR360效果'></td>";
				rst += "<td>"+ data.fid +"</td>";
				rst += "<td>"+ data.fidFp +"</td>";
				rst += "<td>"+ data.fidCv +"</td>";
			}
			else {
				rst += "<td>"+ ary[i][0] +"</td>";
				rst += "<td>"+ data +"</td>";
				rst += "<td>-</td>";
				rst += "<td>-</td>";
				rst += "<td>-</td>";
			}
			rst += "</tr>";
		}
		$("#tbl").append(rst);
	  }
	});

});
//-->
</script>



</body>
</html>
