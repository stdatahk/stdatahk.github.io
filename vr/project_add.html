<html>
<head>
<title>VR360 | Projects | Add</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>

<div id="theDiv" style="text-align:right;">
<input style="width:180px;height:30px;" type=button value="返回 VR360 項目清單" onclick="location.href='project.html';">
</div>
<br>

<table border=0 cellpadding=5 cellspacing=10>
<tr>
<td colspan=2><b>新增一個 VR360 PROJECTS ：</b></td>
</tr>
<tr>
<td>PROJECT ID：</td>
<td>
    <input id="txtTag" size=50 type=text value=""> 
    <input id='btnNewFolder' type=button value="建立雲端目錄夾">
</td>
</tr>
<tr>
<td>PROJECT DETAILS：</td>
<td>
	<input id="txtVal" size=50 type=text value="">
	<br>
	<input id="txtFid" size=50 type=text value="" DISABLED>
	<input type=button value="上載QooCam內的照片" onClick="window.open('project_upload.html?'+document.getElementById('txtFid').value);">
	<br>
	<input id="txtFidFp" size=50 type=text value="" DISABLED>
	<input type=button value="上載單位的平面圖" onClick="window.open('project_upload.html?'+document.getElementById('txtFidFp').value);">
	<font color='red'>(必須)</font>
	<br>
	<input id="txtFidCv" size=50 type=text value="" DISABLED>
	<input type=button value="預覽360效果" onClick="window.open('project_dirlist.html?'+document.getElementById('txtFid').value);">
</td>
</tr>
<tr>
<td>&nbsp;</td>
<td>
	<input id="btnSubmit" type=button value="新增" 
	 style="width:160px;height:50px;">
	<br>
	上載照片到這個雲端資料夾:
	<a id='gDrvUrl' target="_new" href="https://drive.google.com/drive/folders/">Google Drive</a>
</td>
</tr>
</table>

<script language="JavaScript">
<!--
var gasId = "AKfycbwHLSiDw3M30YfAjThHfy0a7BEbzcbho_YPpPXAFAVFD5pWnvg_";
var gssId = "1TZBtReaafWTVzeyDkQzMGFJd4_bycYOhJOmVNdiAMeU"; //for vrproj
var gasUrl = "https://script.google.com/macros/s/"+ gasId +"/exec";

$("#btnSubmit").click(function(){
	$('#btnSubmit').val('正在儲存數據，請稍後...');
	$.ajax({
	  url: gasUrl,
	  cache: false,
	  type: "GET",
	  data: {
		func: 'STORE', 
		id: gssId,  
		key: 'P@$$w0rd!',
		tag: $('#txtTag').val(),
		value: encodeURI(JSON.stringify({	txt: $('#txtVal').val() , 
					fid: $('#txtFid').val() ,
					fidFp: $('#txtFidFp').val() ,
					fidCv: $('#txtFidCv').val() 
	       			     }))
	  },
	  dataType: "html",
	  success: function(html){
		var ary = null;
		html = "ary="+html+";";
		eval(html);
		alert("已成功儲存紀錄: ["+ ary[1] +"],["+ ary[2]+"]");
		location.href = 'project.html';
	  }
	});

});

var gasId2 = "AKfycby5hQM8oo3r7SB_1xlXS76bQIiaxDHjJ_xYgwHzWtPJXriWXj8ozfa3jJ0gKBI7Fgvo";
var gasUrl2 = "https://script.google.com/macros/s/"+ gasId2 +"/exec";

$("#btnNewFolder").click(function(){
	$('#btnNewFolder').val('正在建立雲端目錄夾，請稍後...');
	document.getElementById('btnNewFolder').disabled = true;
	$.ajax({
	  url: gasUrl2,
	  cache: false,
	  type: "GET",
	  data: {
		func: document.getElementById('txtTag').value 
	  },
	  dataType: "html",
	  success: function(html){
		var fId = null;
		html = "fId="+html+";";
		eval(html);
		alert("已成功儲存紀錄: "+ JSON.stringify(fId) );
		document.getElementById('txtFid').value	= fId.projfdr;	  
		document.getElementById('txtFidFp').value = fId.fpfdr;	  
		document.getElementById('txtFidCv').value = fId.confdr;	  
		document.getElementById('gDrvUrl').href += fId.projfdr;	  
		$('#btnNewFolder').val('成功建立雲端目錄夾!');
	  }
	});

});
	
	
function yyyymmdd() {
    var x = new Date();
    var y = x.getFullYear().toString();
    var m = (x.getMonth() + 1).toString();
    var d = x.getDate().toString();
    (d.length == 1) && (d = '0' + d);
    (m.length == 1) && (m = '0' + m);
    var yyyymmdd = y + m + d;
    return yyyymmdd;
}	

document.getElementById('txtTag').value = yyyymmdd();
//-->
</script>



</body>
</html>
